---
aliases:
  - python
date: 2025-05-12
---

# 目录

```dataviewjs
const startHeadinglevel = 2;
const file = app.workspace.getActiveFile();
const { headings } = app.metadataCache.getFileCache(file);
 
// 全列表的形式
const raws = headings.filter(row => row.heading != "目录").map( p => {
    let repeatCount = Math.max((p.level - startHeadinglevel) * 4, 0);
    let spacesPrefix = ' '.repeat( repeatCount + 4 );
    let listSign = repeatCount > 0 ? '- ' : '';
    let linkText = `[[#${p.heading}]]`;
    let headingList = (p.level < startHeadinglevel) ? `- ${linkText}` : `${spacesPrefix}- ${linkText}`;
    return headingList;
  }
)
 
let result = raws.join('\n');
// 添加行距
dv.container.style.lineHeight = "1.5em";
dv.paragraph(result)
```

# 分割字符串

**示例代码**：  
```python
from urllib.parse import parse_qs, urlencode

# 原始查询字符串
query_str = "name=John&age=30&city=NY"

# 1. 分割查询字符串为字典
params = parse_qs(query_str)  # 结果: {'name': ['John'], 'age': ['30'], 'city': ['NY']}

# 2. 替换参数值（如将 age 改为 35）
params['age'] = ['35']

# 3. 重新编码为查询字符串
new_query = urlencode(params, doseq=True)  # name=John&age=35&city=NY
```

**关键方法**：  
- `parse_qs()`：将查询字符串解析为字典（值类型为列表，兼容重复键）。  
- `urlencode()`：将字典重新编码为查询字符串（`doseq=True` 处理列表值）。  

**执行结果**：  
```
原始查询字符串: name=John&age=30&city=NY
替换后查询字符串: name=John&age=35&city=NY
```

# JSON 转字符串



**示例代码**：
```python
import json

# 原始 JSON 数据
json_str = '{"name": "John", "age": 30, "city": "NY"}'
data = json.loads(json_str)  # 解析为字典

# 替换 age 的值为 35
data["age"] = 35

# 生成新 JSON 字符串
new_json_str = json.dumps(data, ensure_ascii=False)  

print(new_json_str)  
# 输出: {"name": "John", "age": 35, "city": "NY"}
```

**关键方法**：
- `json.loads()`：将 JSON 字符串解析为字典
- `json.dumps()`：将字典转回 JSON 字符串
- `ensure_ascii=False`：确保非 ASCII 字符（如中文）正常显示