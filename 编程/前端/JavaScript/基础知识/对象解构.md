---
aliases:
  - JS
date: 2025-05-06
---

# 目录

```dataviewjs
const startHeadinglevel = 2;
const file = app.workspace.getActiveFile();
const { headings } = app.metadataCache.getFileCache(file);
 
// 全列表的形式
const raws = headings.filter(row => row.heading != "目录").map( p => {
    let repeatCount = Math.max((p.level - startHeadinglevel) * 4, 0);
    let spacesPrefix = ' '.repeat( repeatCount + 4 );
    let listSign = repeatCount > 0 ? '- ' : '';
    let linkText = `[[#${p.heading}]]`;
    let headingList = (p.level < startHeadinglevel) ? `- ${linkText}` : `${spacesPrefix}- ${linkText}`;
    return headingList;
  }
)
 
let result = raws.join('\n');
// 添加行距
dv.container.style.lineHeight = "1.5em";
dv.paragraph(result)
```

在你提供的代码中 `{single}` 并不是一个有效的语法结构呀。从上下文推测，你可能想说的是代码中的 `({ signal })` 这种结构，这是**对象解构赋值语法**。

### 对象解构赋值语法解析
对象解构赋值是 ES6 引入的一种简洁语法，用于从对象中提取属性并赋值给变量。

在 `submitForm(async ({ signal }) => { ... })` 这段代码里：
 - `({ signal })` 从一个传入的对象中提取 `signal` 属性，并将其赋值给变量 `signal`。
 - 这个对象是由 `submitForm` 函数在内部创建并传递给作为参数的这个匿名异步函数的。通常，`signal` 可能来自 `AbortController`，用于支持取消异步操作，例如取消一个 API 请求。

以下是一个简单的对象解构赋值示例：
```javascript
// 定义一个对象
const person = { name: 'Alice', age: 30 };

// 使用对象解构赋值提取属性
const { name, age } = person;

console.log(name); // 输出 'Alice'
console.log(age);  // 输出 30
```

在你的代码场景中，`async ({ signal }) => { ... }` 这个箭头函数接收一个包含 `signal` 属性的对象，然后可以在函数内部使用 `signal` 变量。比如：
```javascript
submitForm(async ({ signal }) => {
    // 这里可以使用 signal 变量
    let res = await ins.post('/api/user', form, { signal });
    // 后续逻辑
});
```

这样写使得代码更加简洁和易读，清晰地表明了函数期望接收的对象结构以及要使用的属性。  


---



在 JavaScript 中，`{ signal }` 是 **对象解构语法**（Object Destructuring），用于从传入的参数对象中提取特定属性。以下是具体解析：

---

### 一、语法解析
```javascript
submitForm(async ({ signal }) => { 
  // signal 来自参数对象的解构
});
```
- **`{ signal }`**: 从函数参数对象中提取 `signal` 属性
- **等价写法**：
  ```javascript
  submitForm(async (params) => {
    const signal = params.signal;
    // ...其他代码
  });
  ```

---

### 二、应用场景
#### 1. 提取特定属性
当函数参数是一个对象，但只需其中部分属性时，解构语法可以简化代码：
```javascript
// 解构写法（推荐）
const handleData = ({ id, name }) => {
  console.log(id, name);
};

// 传统写法
const handleData = (data) => {
  const id = data.id;
  const name = data.name;
  console.log(id, name);
};
```

#### 2. 配合 Axios 取消请求
在代码示例中，`signal` 通常来自 [AbortController](https://developer.mozilla.org/en-US/docs/Web/API/AbortController)，用于取消请求：
```javascript
// submitForm 内部实现示例
const submitForm = async (submitFn) => {
  const controller = new AbortController();
  try {
    await submitFn({ signal: controller.signal }); // 传递包含 signal 的参数对象
  } finally {
    // 清理逻辑
  }
};
```

---

### 三、扩展用法
#### 1. 默认值
解构时可为属性设置默认值：
```javascript
const handleConfig = ({ timeout = 5000, retry = 3 }) => {
  console.log(timeout, retry); // 未传值时使用默认值
};
```

#### 2. 嵌套解构
解构多层嵌套对象：
```javascript
const handleUser = ({ 
  id, 
  profile: { name, age } 
}) => {
  console.log(id, name, age);
};

// 调用示例
handleUser({ 
  id: 1, 
  profile: { name: 'John', age: 30 } 
});
```

#### 3. 别名重命名
```javascript
const handleResponse = ({ data: responseData }) => {
  console.log(responseData); // 将 data 重命名为 responseData
};
```

---

### 四、常见问题
#### 1. 参数非对象时报错
```javascript
// ❌ 错误调用（传递非对象参数）
submitForm(async (signal) => { ... }, 123); 

// ✅ 正确调用（传递对象参数）
submitForm(async ({ signal }) => { ... }, { signal: controller.signal });
```

#### 2. 属性不存在时的处理
```javascript
const handleEmpty = ({ signal } = {}) => { 
  // 通过 = {} 设置参数默认值，防止 undefined 报错
  console.log(signal); // undefined
};
```

---

### 五、总结
| 代码               | 含义                             | 应用场景              |
|--------------------|--------------------------------|---------------------|
| `{ signal }`       | 从参数对象解构 `signal` 属性       | 需要提取特定属性时     |
| `{ prop: alias }`  | 从参数对象解构 `prop` 并重命名为 `alias` | 避免命名冲突         |
| `{ key = 'default' }` | 解构时设置默认值               | 防止 undefined 错误 |

通过解构语法，可以更简洁、精准地操作对象属性，是现代 JavaScript 开发的核心技巧之一。

---



在 JavaScript 中，**对象解构（Object Destructuring）** 是一种从对象中提取属性并赋值给变量的便捷语法。以下是其核心用法和场景解析：

---

### 一、基础语法
#### 1. 提取单个属性
```javascript
const user = { name: 'John', age: 30 };

// 解构 name 属性
const { name } = user;
console.log(name); // 'John'
```

#### 2. 提取多个属性
```javascript
const { name, age } = user;
console.log(name, age); // 'John' 30
```

#### 3. 重命名属性
```javascript
const { name: userName, age: userAge } = user;
console.log(userName); // 'John'
```

---

### 二、进阶用法
#### 1. 默认值
当解构的属性不存在时，设置默认值：
```javascript
const { role = 'guest' } = user;
console.log(role); // 'guest'（若 user 无 role 属性）
```

#### 2. 嵌套解构
解构嵌套对象：
```javascript
const user = { 
  profile: { 
    email: 'john@example.com' 
  } 
};

const { profile: { email } } = user;
console.log(email); // 'john@example.com'
```

#### 3. 函数参数解构
直接在参数中解构：
```javascript
function printUser({ name, age }) {
  console.log(`${name} is ${age} years old`);
}

printUser(user); // 'John is 30 years old'
```

---

### 三、实际应用场景
#### 1. 处理 API 响应
```javascript
// 假设返回的数据结构
const response = {
  data: { id: 1, title: 'Hello World' },
  status: 200
};

// 解构所需数据
const { data: post, status } = response;
console.log(post.title); // 'Hello World'
```

#### 2. 表单错误处理
```javascript
// Element Plus 验证错误对象
const error = {
  fields: {
    email: [{ message: 'Invalid email' }]
  }
};

// 解构错误消息
const { fields: { email: [firstError] } } = error;
console.log(firstError.message); // 'Invalid email'
```

#### 3. 结合函数参数
```javascript
// 提交表单函数
const handleSubmit = async ({ signal }) => {
  await axios.post('/api/submit', data, { signal });
};

// 调用时传递参数对象
handleSubmit({ signal: controller.signal });
```

---

### 四、常见错误与解决
#### 1. 解构 `undefined` 对象
```javascript
// ❌ 错误：解构未定义对象
const { name } = undefined; // TypeError

// ✅ 修复：设置默认空对象
const { name } = undefined || {};
```

#### 2. 深层嵌套安全解构
```javascript
// ❌ 危险：直接解构可能不存在的层级
const { profile: { email } } = user; // 若 profile 不存在会报错

// ✅ 安全：使用默认值 + 可选链
const { profile: { email } = {} } = user;
```

---

### 五、总结
| 特性                 | 示例                   | 作用                     |
|----------------------|-----------------------|-------------------------|
| **基础解构**          | `const { prop } = obj` | 提取单个属性             |
| **默认值**            | `const { prop = 1 }`   | 防 undefined 错误       |
| **重命名**            | `const { prop: newName }` | 解决命名冲突         |
| **嵌套解构**          | `const { a: { b } }`  | 提取嵌套属性             |

对象解构能显著提升代码可读性和简洁性，建议在以下场景优先使用：
- 处理 API 返回数据  
- 函数参数传递  
- 状态管理（如 Vuex 或 Pinia 的 store）  
- 组件 props 接收